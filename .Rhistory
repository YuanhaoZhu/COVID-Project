#We use the raw data in sheet 2 for data processing. The transformed data is ill structured. For instance ln1 is 0 and missing values were also assigned value 0.
library("readxl")
library("dplyr")
rawdata <- read_excel("COVID.xlsx", sheet = "Sheet2",col_names=T,range = cell_cols(1:9))
rawdata
colnames(rawdata)<-c("CODE","COUNTRY",	"DATE",	"TC",	"TD","STI",	"POP","GDPCAP","HDI")
#a function take natrual log and leave 0 if the cell is 0 and NA if the cell is NA
avoid_zero_ln<-function(x){
n=ifelse(x == 0, 0, log(x))
return(n)
}
data<-rawdata %>% mutate_at(c("TC",	"TD","STI",	"POP","GDPCAP"), avoid_zero_ln)
colnames(data)<-c("CODE","COUNTRY",	"DATE",	"logTC",	"logTD","logSTI",	"logPOP","logGDPCAP","HDI")
#keep both variables in log scale and original ones.
#The processed data is  called covid. Note that NA values are perserved.
covid<-cbind(data,rawdata[,c(4:8)])
head(covid)
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
head(covid)
study_data <- covid[, 1:4]
final_data
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
head(covid)
study_data <- covid[, 1:4]
head(study_data)
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
head(covid)
study_data <- covid[, 8:14]
head(study_data)
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
head(covid)
study_data <- covid[, 9:14]
head(study_data)
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
study_data <- covid[, 9:14]
summary(study_data)
cor(study_data)
# Hide upper triangle
upper<-cor(study_data)
upper[upper.tri(mcor)]<-""
# Hide upper triangle
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
library(xtable)
library(xtable)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
print(xtable(upper), type="html")
library(xtable)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
print(xtable(upper))
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
covid<-cbind(data,rawdata[,c(4:8)])
covid$DATE <- as.Date(covid$DATE , format = "%Y-%m-%d")
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
# covid <- drop_na(covid)
study_data <- covid[, 9:14]
summary(study_data)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
covid
study_data <- covid[, 9:14]
study_data
covid
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
study_data <- covid[, 4:9]
study_data
summary(study_data)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid <- drop_na(covid)
study_data <- covid[, 9:14]
study_data
summary(study_data)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
#We use the raw data in sheet 2 for data processing. The transformed data is ill structured. For instance ln1 is 0 and missing values were also assigned value 0.
library("readxl")
library("dplyr")
rawdata <- read_excel("COVID.xlsx", sheet = "Sheet2",col_names=T,range = cell_cols(1:9))
colnames(rawdata)<-c("CODE","COUNTRY",	"DATE",	"TC",	"TD","STI",	"POP","GDPCAP","HDI")
#a function take natrual log and leave 0 if the cell is 0 and NA if the cell is NA
avoid_zero_ln<-function(x){
n=ifelse(x == 0, 0, log(x))
return(n)
}
data<-rawdata %>% mutate_at(c("TC",	"TD","STI",	"POP","GDPCAP"), avoid_zero_ln)
colnames(data)<-c("CODE","COUNTRY",	"DATE",	"logTC",	"logTD","logSTI",	"logPOP","logGDPCAP","HDI")
#keep both variables in log scale and original ones.
#The processed data is  called covid. Note that NA values are perserved.
covid<-cbind(data,rawdata[,c(4:8)])
head(covid)
covid<-cbind(data,rawdata[,c(4:8)])
covid$DATE <- as.Date(covid$DATE , format = "%Y-%m-%d")
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid[is.na(covid)] <- 0
study_data <- covid[, 4:9]
summary(study_data)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid[is.na(covid)] <- 0
study_data <- covid[, 9:14]
summary(study_data)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid[is.na(covid)] <- 0
study_data <- covid[, c(9,10,11,12,14)]
summary(study_data)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
# OLS
pov <- lm(HDI~., study_data)
summary(pov)
require(foreign)
require(MASS)
summary(study_data)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
# OLS
pov <- lm(HDI~., study_data)
summary(pov)
# OLS
pov.ols <- lm(HDI~., study_data)
summary(pov.ols)
plot(pov.ols)
# OLS
pov.ols <- lm(HDI~., study_data)
summary(pov.ols)
opar <- par(mfrow = c(2,2), oma = c(0, 0, 1.1, 0))
plot(pov.ols, las = 1)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.bisquare)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.bisquare)
summary(pov.rls)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.bisquare)
summary(pov.rls)
opar <- par(mfrow = c(2,2), oma = c(0, 0, 1.1, 0))
plot(pov.rls, las = 1)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.bisquare)
summary(pov.rls)
# opar <- par(mfrow = c(2,2), oma = c(0, 0, 1.1, 0))
plot(pov.rls)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.bisquare)
summary(pov.rls)
anova(pov.ols, pov.rls)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.bisquare)
summary(pov.rls)
# RLS
pov.rls <- rlm(HDI~. , data=study_data) #, psi = psi.bisquare
summary(pov.rls)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.hampel) #, psi = psi.bisquare
summary(pov.rls)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.hampel) #, psi = psi.bisquare
summary(pov.rls)
# Weighted R2
r2ww <- function(x){
SSe <- sum((x$w*x$resid)^2); #the residual sum of squares is weighted
observed <- x$resid+x$fitted;
SSt <- sum((x$w*(observed-mean(observed)))^2); #the total sum of squares is weighted
value <- 1-SSe/SSt;
return(value);
}
r2ww(pov.rls)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.hampel) #, psi = psi.bisquare
summary(pov.rls)
# Weighted R2
r2ww <- function(x){
SSe <- sum((x$w*x$resid)^2); #the residual sum of squares is weighted
observed <- x$resid+x$fitted;
SSt <- sum((x$w*(observed-mean(observed)))^2); #the total sum of squares is weighted
value <- 1-SSe/SSt;
return(value);
}
print(paste0("Weighted R2 = ", r2ww(pov.rls)))
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.hampel) #, psi = psi.bisquare
summary(pov.rls)
# Weighted R2
r2ww <- function(x){
SSe <- sum((x$w*x$resid)^2); #the residual sum of squares is weighted
observed <- x$resid+x$fitted;
SSt <- sum((x$w*(observed-mean(observed)))^2); #the total sum of squares is weighted
value <- 1-SSe/SSt;
return(value);
}
print(paste0("Weighted R2 = ",round(r2ww(pov.rls),5)))
covid
our_data <- covid[, c(9,10,11,12,14,15,16,17)]
our_data <- covid[, c(9,10,11,12,14,15,16,17)]
head(our_data)
#We use the raw data in sheet 2 for data processing. The transformed data is ill structured. For instance ln1 is 0 and missing values were also assigned value 0.
library("readxl")
library("dplyr")
rawdata <- read_excel("COVID.xlsx", sheet = "Sheet2",col_names=T,range = cell_cols(1:9))
colnames(rawdata)<-c("CODE","COUNTRY",	"DATE",	"TC",	"TD","STI",	"POP","GDPCAP","HDI")
#a function take natrual log and leave 0 if the cell is 0 and NA if the cell is NA
avoid_zero_ln<-function(x){
n=ifelse(x == 0, 0, log(x))
return(n)
}
data<-rawdata %>% mutate_at(c("TC",	"TD","STI",	"POP","GDPCAP"), avoid_zero_ln)
colnames(data)<-c("CODE","COUNTRY",	"DATE",	"logTC",	"logTD","logSTI",	"logPOP","logGDPCAP","HDI")
#keep both variables in log scale and original ones.
#The processed data is  called covid. Note that NA values are perserved.
covid<-cbind(data,rawdata[,c(4:8)])
covid
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid[is.na(covid)] <- 0
study_data <- covid[, c(9,10,11,12,14)]
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
covid[is.na(covid)] <- 0
study_data <- covid[, 4:9] # c(9,10,11,12,14)
summary(study_data)
# Time Phase
begin_phase = min(covid$DATE)
dev_phase = as.Date("2020-03-01", format = "%Y-%m-%d")
outbreak_phase = as.Date("2020-07-01", format = "%Y-%m-%d")
# 0 = beginning phase, 1 = developing phase, 2 = outbreak phase
covid <- mutate(covid, phase = case_when(
DATE < dev_phase ~ 0,
DATE >= dev_phase & DATE < outbreak_phase ~ 1,
DATE >= outbreak_phase ~ 2
))
covid <- mutate(covid, mortality_rate = TC/TD)
# 0 = UNDERDEVELOPED, 1 = DEVELOPING, 2 = DEVELOPED
covid$type[covid$GDPCAP<5338.454]<-0
covid$type[covid$GDPCAP>= 5338.454 & covid$GDPCAP<31400.840]<- 1
covid$type[covid$GDPCAP>=31400.840 ]<- 2
# covid[is.na(covid)] <- 0
covid <- covid %>% drop_na()
study_data <- covid[, 4:9] # c(9,10,11,12,14)
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
upper<-cor(study_data)
upper[upper.tri(cor(study_data))]<-""
upper<-as.data.frame(upper)
upper
# OLS
pov.ols <- lm(HDI~., data = study_data)
summary(pov.ols)
opar <- par(mfrow = c(2,2), oma = c(0, 0, 1.1, 0))
plot(pov.ols, las = 1)
# RLS
pov.rls <- rlm(HDI~. , data=study_data, psi = psi.hampel) #, psi = psi.bisquare
summary(pov.rls)
# Weighted R2
r2ww <- function(x){
SSe <- sum((x$w*x$resid)^2); #the residual sum of squares is weighted
observed <- x$resid+x$fitted;
SSt <- sum((x$w*(observed-mean(observed)))^2); #the total sum of squares is weighted
value <- 1-SSe/SSt;
return(value);
}
print(paste0("Weighted R2 = ",round(r2ww(pov.rls),5)))
# OLS
pov.ols <- lm(GDPCAP~., data = study_data)
# OLS
pov.ols <- lm(logGDPCAP~., data = study_data)
summary(pov.ols)
opar <- par(mfrow = c(2,2), oma = c(0, 0, 1.1, 0))
plot(pov.ols, las = 1)
# RLS
pov.rls <- rlm(logGDPCAP~. , data=study_data, psi = psi.hampel) #, psi = psi.bisquare
summary(pov.rls)
# Weighted R2
r2ww <- function(x){
SSe <- sum((x$w*x$resid)^2); #the residual sum of squares is weighted
observed <- x$resid+x$fitted;
SSt <- sum((x$w*(observed-mean(observed)))^2); #the total sum of squares is weighted
value <- 1-SSe/SSt;
return(value);
}
print(paste0("Weighted R2 = ",round(r2ww(pov.rls),5)))
